---
title: "chapter1 exercises"
author: "Lijia Wang, Samantha Marglous"
date: "2020-06-24"
output: workflowr::wflow_html
editor_options:
  chunk_output_type: console
---

## Chapter 1.3, Gaussian Elimination

```{r, echo=FALSE}
# Required packages
library(workflowr)
setwd("~/Documents/GitHub/linalg/")
```


## Gaussian Elimination Function

```{r}
# write a function for Gaussian Elimination on nx(n+1) matrix
ge <- function(matrix) {
  n <- dim(matrix)[1]
  new_matrix <- matrix
  
  # row reduction
  for (ind in 2:n) {
    for (row in ind:n) {
      # print(paste("ind", ind))
      div <- new_matrix[row,row-1] / new_matrix[row-1,row-1]
      # print(paste("div", div))
      tmp <- div * new_matrix[row-1,]
      # print(paste("tmp", tmp))
      new_matrix[row,] <- new_matrix[row,] - tmp
    }
  }
  
  # Back substitution
  ans <- rep(0, n)
  for (var in n:1) {
    ans[var] <- (new_matrix[var, n+1] - new_matrix[var, 1:n] %*% ans) / new_matrix[var, var]
    print(ans[var])
  }
    
  return(ans)
}
```


## Some sample matrices from exercises in 1.3

```{r}
# 2x2, problem 3
mat1 <- matrix(c(2,-1,-4,5,6,0), 2, 3)
#      [,1] [,2] [,3]
# [1,]    2   -4    6
# [2,]   -1    5    0
e1 <- ge(mat1)
# [1] 5 1

# 3x3, problem 10
mat2 <- matrix(c(2,4,0,3,7,-2,1,5,2,8,20,0), 3, 4)
#      [,1] [,2] [,3] [,4]
# [1,]    2    3    1    8
# [2,]    4    7    5   20
# [3,]    0   -2    2    0
e2 <- ge(mat2)
# [1] 2 1 1

# 4x4, problem 20
mat3 <- matrix(c(2,1,0,0,1,2,1,0,0,1,2,1,0,0,1,2,0,0,0,5), 4,5)
#      [,1] [,2] [,3] [,4] [,5]
# [1,]    2    1    0    0    0
# [2,]    1    2    1    0    0
# [3,]    0    1    2    1    0
# [4,]    0    0    1    2    5
e3 <- ge(mat3)
# [1] -1  2 -3  4

# singular matrix on page 13 (no solution)
mat4 <- matrix(c(1,2,4,1,2,4,1,5,8,5,6,7), 3,4)
#      [,1] [,2] [,3] [,4]
# [1,]    1    1    1    5
# [2,]    2    2    5    6
# [3,]    4    4    8    7
e4 <- ge(mat4)

# singular matrix (inf solution)
mat5 <- matrix(c(1,2,4,1,2,4,1,4,8,5,6,12), 3,4)
#      [,1] [,2] [,3] [,4]
# [1,]    1    1    1    5
# [2,]    2    2    4    6
# [3,]    4    4    8    12
e5 <- ge(mat5)
```


```{r, eval=FALSE}
# scratch

for (row in 2:n) {
      div <- matrix[row,1] / matrix[1,1]
      print(paste("div", div))
      tmp <- div * matrix[1,]
      print(paste("tmp", tmp))
      new_matrix[row,] <- matrix[row,] - tmp
    }

# run code below to update site:
wflow_status()
wflow_publish(c("analysis/chapter1.Rmd", "analysis/index.Rmd"), "updated workflowr site")
wflow_git_push()
```

